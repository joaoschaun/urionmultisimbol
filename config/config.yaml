# Urion Trading Bot Configuration

# MetaTrader 5
mt5:
  login: ${MT5_LOGIN}
  password: ${MT5_PASSWORD}
  server: ${MT5_SERVER}
  path: ${MT5_PATH}
  timeout: 60000
  max_reconnect_attempts: 5

# Trading Parameters
trading:
  symbol: XAUUSD
  timeframes:
    - M1
    - M5
    - M15
    - M30
    - H1
    - H4
    - D1
  default_lot_size: 0.01
  min_lot_size: 0.01
  max_lot_size: 1.0
  max_open_positions: 3  # CRITICAL: Max simultaneous positions
  spread_threshold: 30
  slippage: 10

# Risk Management
risk:
  max_risk_per_trade: 0.02  # 2% do capital
  max_drawdown: 0.15  # 15%
  max_daily_loss: 0.05  # 5%
  stop_loss_pips: 20
  take_profit_pips: 40
  trailing_stop_enabled: true
  trailing_stop_distance: 15
  break_even_enabled: true
  break_even_trigger: 15

# Trading Schedule
schedule:
  timezone: UTC
  trading_days: [0, 1, 2, 3, 4]  # Segunda a Sexta
  market_open:
    hour: 18
    minute: 30
  market_close:
    hour: 16
    minute: 30
  weekend_close:
    day: 5  # Sexta
    hour: 16
    minute: 30
  weekend_open:
    day: 0  # Domingo
    hour: 18
    minute: 30
  avoid_news_minutes_before: 0  # Desativado para teste
  avoid_news_minutes_after: 0   # Desativado para teste

# Strategy Configuration
strategies:
  enabled:
    - trend_following
    - mean_reversion
    - breakout
    - news_trading
    - scalping
  
  trend_following:
    enabled: true
    timeframe: H1
    cycle_seconds: 900  # 15 minutos
    max_positions: 2
    min_confidence: 0.65
    ema_fast: 12
    ema_slow: 26
    adx_threshold: 25
    min_trend_strength: 0.6
  
  mean_reversion:
    enabled: true
    timeframe: M15
    cycle_seconds: 600  # 10 minutos
    max_positions: 2
    min_confidence: 0.70
    bollinger_period: 20
    bollinger_std: 2
    rsi_period: 14
    rsi_overbought: 70
    rsi_oversold: 30
  
  breakout:
    enabled: true
    timeframe: M30
    cycle_seconds: 1800  # 30 minutos
    max_positions: 2
    min_confidence: 0.75
    support_resistance_lookback: 50
    breakout_confirmation_candles: 2
    volume_threshold: 1.5
  
  news_trading:
    enabled: true
    cycle_seconds: 300  # 5 minutos
    max_positions: 2
    min_confidence: 0.80
    high_impact_only: true
    min_sentiment_confidence: 0.7
    trade_on_prediction: true
  
  scalping:
    enabled: true
    timeframe: M5
    cycle_seconds: 60  # 1 minuto (rápido!)
    max_positions: 2
    min_confidence: 0.60
    max_spread_pips: 3
    min_momentum: 0.0002
    rsi_min: 40
    rsi_max: 60
    target_pips: 8
    stop_pips: 4
    min_volume_ratio: 1.2
  
  # Estratégia 6: Range Trading (mercado lateral/consolidado)
  range_trading:
    enabled: true
    timeframe: M5
    cycle_seconds: 180  # 3 minutos
    max_positions: 2
    min_confidence: 0.50  # Mais fácil (ideal para mercado sem tendência)
    adx_max: 25  # ADX abaixo de 25 = mercado lateral
    rsi_buy_min: 35  # Compra quando RSI entre 35-45
    rsi_buy_max: 45
    rsi_sell_min: 55  # Vende quando RSI entre 55-65
    rsi_sell_max: 65
    stoch_low: 30
    stoch_high: 70
    bb_touch_threshold: 0.003  # 0.3% da banda

# Technical Analysis
technical_analysis:
  indicators:
    # Trend Indicators
    - name: EMA
      periods: [9, 21, 50, 200]
    - name: SMA
      periods: [20, 50, 100, 200]
    - name: MACD
      fast: 12
      slow: 26
      signal: 9
    - name: ADX
      period: 14
    
    # Momentum Indicators
    - name: RSI
      period: 14
    - name: Stochastic
      k_period: 14
      d_period: 3
    - name: CCI
      period: 20
    
    # Volatility Indicators
    - name: Bollinger Bands
      period: 20
      std: 2
    - name: ATR
      period: 14
    - name: Keltner Channel
      period: 20
      multiplier: 2
    
    # Volume Indicators
    - name: Volume
    - name: OBV
    - name: MFI
      period: 14
  
  patterns:
    - Doji
    - Hammer
    - Shooting Star
    - Engulfing
    - Morning Star
    - Evening Star
    - Three White Soldiers
    - Three Black Crows

# Machine Learning
ml:
  enabled: true
  model_type: ensemble  # ensemble, lstm, xgboost
  retrain_frequency: daily
  min_training_samples: 1000
  features:
    - price_change
    - volume_change
    - rsi
    - macd
    - bollinger_position
    - atr
    - time_of_day
    - day_of_week
    - news_sentiment
  target: profitable_trade
  validation_split: 0.2
  test_split: 0.1

# News Analysis
news:
  sources:
    - forexnews
    - finazon
    - financialmodelingprep
  
  sentiment_analysis:
    enabled: true
    model: transformer  # transformer, vader, textblob
    confidence_threshold: 0.60  # Reduzido de 0.7 para 0.60 (60%)
  
  impact_levels:
    high:
      - NFP
      - FOMC
      - CPI
      - GDP
      - Interest Rate Decision
    medium:
      - Unemployment
      - Retail Sales
      - Manufacturing PMI
    low:
      - Consumer Confidence
      - Housing Data

# Order Generator
order_generator:
  enabled: true
  cycle_interval_seconds: 300  # 5 minutos
  min_signal_confidence: 0.6
  require_consensus: true  # Usar consenso de estratégias
  trading_hours:
    start_hour: 0
    start_minute: 0
    end_hour: 23
    end_minute: 59

# Order Manager
order_manager:
  enabled: true
  cycle_interval_seconds: 60  # 1 minuto
  partial_close:
    enabled: true
    target_pips: 30  # Fechar parcial quando atingir 30 pips
    close_percentage: 0.5  # Fechar 50% da posição

# Notifications
notifications:
  telegram:
    enabled: true
    send_trade_signals: true
    send_trade_executions: true
    send_trade_closures: true
    send_daily_summary: true
    send_errors: true
    send_warnings: true
  
  email:
    enabled: false
    smtp_server: smtp.gmail.com
    smtp_port: 587
    from_email: ""
    to_email: ""

# Logging
logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  handlers:
    - console
    - file
    - rotating_file
  file_path: logs/urion.log
  max_file_size: 10485760  # 10MB
  backup_count: 10

# Database
database:
  url: ${DATABASE_URL}
  pool_size: 10
  max_overflow: 20
  echo: false

# Redis
redis:
  url: ${REDIS_URL}
  decode_responses: true
  max_connections: 50

# Monitoring
monitoring:
  prometheus_enabled: false
  prometheus_port: 9090
  sentry_enabled: false
  sentry_dsn: ${SENTRY_DSN}
  
  metrics:
    - total_trades
    - winning_trades
    - losing_trades
    - win_rate
    - profit_factor
    - sharpe_ratio
    - max_drawdown
    - average_trade_duration
